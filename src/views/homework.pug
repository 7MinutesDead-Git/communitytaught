extends layouts/default.pug

block variables
	- const title = "Homework"
	- active = "Homework"

block content
	if (!loggedIn)
		include ./partials/flash-nologin.pug

	h1.mb-4 All Homework
	each hw in homework
		div(class="grid grid-cols-[220px_1fr_200px] mb-12" class=(hw.submitted || !hw.submit.length) && hw.items.every(item => item.done) ? "done" : "" id=hw._id)
			.hw-classNo
				if (hw.classNo.length === 1)
					h2 Class #{hw.classNo[0]}
				else if (hw.classNo.length === 2)
					h2 Classes #{hw.classNo[0]} &amp; #{hw.classNo[1]}
				else
					h2 Classes #{hw.classNo[0]} - #{hw.classNo.at(-1)}
				if (loggedIn && user.admin)
					a.ml-2(href=`/hw/edit/${hw._id}`)
						i.fas.fa-pencil
			.hw-items
				if hw.items.length
					ul
						each item in hw.items
							li.relative.ml-3
								if item.required
									span.required(title="Must submit" class="absolute -left-5 top-1 text-red-800 text-2xl cursor-default") *
								if (loggedIn)
									input.item.mr-3(type="checkbox" id=`item-${item._id}` autocomplete="off" checked=item.done data-hw=hw._id)
									label(for=`item-${item._id}`) #{item.class !== hw.classNo[0] ? `(Class ${item.class}) ` : ""}!{item.description}
								else
									| !{item.description}
					if hw.extras.length
						h3 Extras
						ul
							each extra in hw.extras
								li.ml-3
									if (loggedIn)
										input.extra.mr-3(type="checkbox" id=`extra-${extra._id}` autocomplete="off" checked=extra.done)
										label(for=`item-${extra._id}` ) !{extra.description}
									else
										| !{extra.description}
			.hw-due
				h2.mb-4.text-twilight-800 Due Class #{hw.dueNo}
				if hw.submit
					a.submit-button.text-center(href=hw.submit target="_blank") Submit
					if (loggedIn)
							input.submitted.mr-3(type="checkbox" id=`submit-${hw._id}` autocomplete="off" checked=hw.submitted data-hw=hw._id)
							label(for=`submit-${hw._id}`) Submitted


				if (hw.note)
						p.italic.text-sm.mt-2 !{hw.note}

	//- table.homework
	//- 	thead
	//- 		tr.text-2xl
	//- 			th Class
	//- 			//- if (loggedIn)
	//- 			//- 	th Done
	//- 			th Assignment
	//- 			th.hw-submit Submit
	//- 			if (loggedIn && user.admin)
	//- 				th Edit
	//- 	tbody
	//- 		each hw in homework
	//- 			- const multiClass = hw.items.some(item => item.class !== hw.classNo[0])

	//- 			tr(class=(hw.submitted || !hw.submit.length) && hw.items.every(item => item.done) ? "done" : "" id=hw._id)
	//- 				td
	//- 					if (hw.classNo.length === 1)
	//- 						|	#{hw.classNo[0]}
	//- 					else if (hw.classNo.length === 2)
	//- 						| #{hw.classNo[0]} &amp; #{hw.classNo[1]}
	//- 					else
	//- 						| #{hw.classNo[0]} - #{hw.classNo.at(-1)}
	//- 				//- if (loggedIn)
	//- 				//- 	td
	//- 				//- 		input.done(type="checkbox" id="done-" + hw._id autocomplete="off")
	//- 				td.hw-items
	//- 					if hw.items.length
	//- 						ul
	//- 							each item in hw.items
	//- 								li.relative
	//- 									if item.required
	//- 										span.required(title="Must submit") *
	//- 									if (loggedIn)
	//- 										input.item(type="checkbox" id=`item-${item._id}` autocomplete="off" checked=item.done data-hw=hw._id)
	//- 										label(for=`item-${item._id}`) #{item.class !== hw.classNo[0] ? `(Class ${item.class}) ` : ""}!{item.description}
	//- 									else
	//- 										| !{item.description}
	//- 						if hw.extras.length
	//- 							h3 Extras
	//- 							ul
	//- 								each extra in hw.extras
	//- 									li
	//- 										if (loggedIn)
	//- 											input.extra(type="checkbox" id=`extra-${extra._id}` autocomplete="off" checked=extra.done)
	//- 											label(for=`item-${extra._id}` ) !{extra.description}
	//- 										else
	//- 											| !{extra.description}
	//- 				td.hw-submit
	//- 					h2.mb-4.text-twilight-800 Due Class #{hw.dueNo}
	//- 					if hw.submit
	//- 						a.submit-button(href=hw.submit target="_blank") Submit
	//- 						if (loggedIn)
	//- 								input.submitted(type="checkbox" id=`submit-${hw._id}` autocomplete="off" checked=hw.submitted data-hw=hw._id)
	//- 								label(for=`submit-${hw._id}`) Submitted


	//- 					if (hw.note)
	//- 							p.italic.text-sm.mt-2 !{hw.note}
	//- 				if (loggedIn && user.admin)
	//- 					td
	//- 						a.ml-2(href=`/hw/edit/${hw._id}`)
	//- 							i.fas.fa-pencil

	#to-top
		i.far.fa-square-caret-up(title="Back to top")

block extra-scripts
	script(src="/js/toTop.js")
	if loggedIn
		script(src="/js/hwProgress.js")
		script(src="/js/hwDone.js")
